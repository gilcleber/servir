{"version":3,"sources":["../../../../../../../../Desktop/GIL%20CLEBER/SERVIR/serving-app/src/actions/leader.ts"],"sourcesContent":["'use server'\r\n\r\nimport { createClient } from '@/lib/supabase/server'\r\n\r\nexport async function fetchLeaderStats() {\r\n    const supabase = await createClient()\r\n\r\n    // In a real app, strict filtering by hierarchy/ministry\r\n    // MVP: Count all assignments mostly\r\n\r\n    // Confirmed\r\n    const { count: confirmed } = await supabase\r\n        .from('assignments')\r\n        .select('*', { count: 'exact', head: true })\r\n        .eq('status', 'confirmed')\r\n\r\n    // Pending\r\n    const { count: pending } = await supabase\r\n        .from('assignments')\r\n        .select('*', { count: 'exact', head: true })\r\n        .eq('status', 'pending')\r\n\r\n    const total = (confirmed || 0) + (pending || 0)\r\n    const rate = total > 0 ? Math.round(((confirmed || 0) / total) * 100) : 0\r\n\r\n    return {\r\n        confirmed: confirmed || 0,\r\n        pending: pending || 0,\r\n        confirmationRate: rate\r\n    }\r\n}\r\n\r\nexport async function fetchActiveSchedules() {\r\n    // Determine \"Active\" (e.g. today or next Sunday)\r\n    // MVP: Fetch next 3 assignments with details\r\n    const supabase = await createClient()\r\n\r\n    const { data } = await supabase\r\n        .from('schedules')\r\n        .select(`\r\n            *,\r\n            ministries(*),\r\n            service_times(*),\r\n            assignments(\r\n                *,\r\n                profiles(name, role, avatar_url)\r\n            )\r\n        `)\r\n        .order('date', { ascending: true })\r\n        .limit(3)\r\n\r\n    return data || []\r\n}\r\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,MAEO,eAAe,IAClB,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAM7B,CAAE,MAAO,CAAS,CAAE,CAAG,MAAM,EAC9B,IAAI,CAAC,eACL,MAAM,CAAC,IAAK,CAAE,MAAO,QAAS,MAAM,CAAK,GACzC,EAAE,CAAC,SAAU,aAGZ,CAAE,MAAO,CAAO,CAAE,CAAG,MAAM,EAC5B,IAAI,CAAC,eACL,MAAM,CAAC,IAAK,CAAE,MAAO,QAAS,MAAM,CAAK,GACzC,EAAE,CAAC,SAAU,WAEZ,EAAQ,CAAC,IAAa,CAAC,EAAK,EAAD,EAAY,CAAC,CACxC,EAAO,EAAQ,EAAI,KAAK,KAAK,CAAE,CAAC,IAAa,CAAC,CAAI,EAAS,KAAO,EAExE,MAAO,CACH,UAAW,GAAa,EACxB,QAAS,GAAW,EACpB,iBAAkB,CACtB,CACJ,CAEO,eAAe,IAGlB,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,MAAE,CAAI,CAAE,CAAG,MAAM,EAClB,IAAI,CAAC,aACL,MAAM,CAAC,CAAC;;;;;;;;QAQT,CAAC,EACA,KAAK,CAAC,OAAQ,CAAE,WAAW,CAAK,GAChC,KAAK,CAAC,GAEX,OAAO,GAAQ,EAAE,AACrB,0CAhDsB,EA4BA,IA5BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA4BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA"}